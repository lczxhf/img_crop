<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="Access-Control-Allow-Origin" content="*">
<!-- 		<link rel="stylesheet" href="../css/bootstrap.min.css"> -->
  		 <script src="../js/jquery-2.1.0.js"></script>
<!--    		<script src="../js/bootstrap.min.js"></script>	 -->
        <script src="../js/lzh_img_crop.js"></script>
      <script type="text/javascript">
        $(document).ready(function () {
          $("#myfile").change(function(e){
            var file = e.target.files[0]
            if(file){
              var reader = new FileReader();
                      reader.onload=function(){
                        var image=new Image();
                        image.src = reader.result;
                        crop = new LzhImgCrop(image,'mycan','preview_can',image.naturalWidth,image.naturalHeight);
                      }
                      reader.readAsDataURL(file);
            }
          })
      });
        function submit(){
            file = crop.GetResultData();
             var form = new FormData();
             form.append('file',file); 
             var xhr = new XMLHttpRequest();
            xhr.open("post","http://weixin.29mins.com/wechat/third_party/test2", true);
            xhr.onload = function(){
                alert(xhr.responseText)
            }
            xhr.send(form);
            
        }
      </script>
   		</head>
	<body>
		<input type="file" id="myfile"/>
		<canvas id="mycan"></canvas>
        <canvas id="preview_can"></canvas>
        <button type="button" onclick="submit()">提交</button>
	</body>
</html>